(this.webpackJsonppersonal_spending=this.webpackJsonppersonal_spending||[]).push([[0],{259:function(t,e,n){},286:function(t,e){},288:function(t,e){},488:function(t,e,n){"use strict";n.r(e);var a=n(7),s=n(0),r=n.n(s),i=n(55),o=n.n(i),c=(n(259),n(164)),u=n(75),l=n.n(u),h=n(225),d=n(226),m=n(227),j=n(50),f=n(228),b=n(248),v=n(79),x=n.n(v),p=(n(231),n(156)),O=n.n(p),g=n(493),y=n(497),M=n(114),D=n(115),k=n(123),Y=n(92),w=n(245),E=n(498),S=n(249),C=n(157),F=n.n(C),N=(n(263),n(264),n(492)),_=n(502),B=n(499),U=n(500),K=n(232),T=n.n(K),L=n(233),I=n(121),A=n.n(I),H=T.a.get,J=function(t){Object(f.a)(n,t);var e=Object(b.a)(n);function n(t){var a;return Object(d.a)(this,n),(a=e.call(this,t)).state={data:null},a.setNewData=a.setNewData.bind(Object(j.a)(a)),a.setStartDate=a.setStartDate.bind(Object(j.a)(a)),a.setEndDate=a.setEndDate.bind(Object(j.a)(a)),a.checkboxMovement=a.checkboxMovement.bind(Object(j.a)(a)),a.clearUrl=a.clearUrl.bind(Object(j.a)(a)),a}return Object(m.a)(n,[{key:"fetchData",value:function(){var t=Object(h.a)(l.a.mark((function t(){var e,n,a,s,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(e=this.storedUrl)||(this.storedUrl=window.prompt("Please enter the URL to search:"),e=this.storedUrl,A.a.set("url",e)),t.next=4,H(e);case 4:return n=t.sent,a=n.data,s=a.split("\n"),r=[],s.map((function(t){L.read(t,",",(function(t){r.push(t)}))})),t.abrupt("return",r);case 10:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var t=this;this.fetchData().then((function(e){console.log({data:e}),t.setNewData(e)})).catch((function(t){console.error({err:t})}))}},{key:"parseNewMovements",value:function(t){var e=[],n=0;return t.forEach((function(t,a){if(0!=a){n+=O()(t[2]).value();var s=x()(t[0],"DD/MM/YYYY");e.push({date:s.format("DD/MM/YYYY"),dateMillis:s.toDate().getTime(),motive:t[1].toLowerCase(),ammount:O()(t[2]).value(),sum:n,sum_display:parseFloat(Number(n).toFixed(2))})}})),e}},{key:"recalculateData",value:function(t){var e=0,n=[];return t.forEach((function(t,a){if(0!=a){e+=t.ammount;var s=x()(t.date,"DD/MM/YYYY");n.push({date:s.format("DD/MM/YYYY"),dateMillis:s.toDate().getTime(),motive:t.motive.toLowerCase(),ammount:t.ammount,sum:e,sum_display:parseFloat(Number(e).toFixed(2))})}})),n}},{key:"setNewData",value:function(t){var e=this;console.log({data:t}),this.setState({movements:this.parseNewMovements(t)},(function(){return e.setMovements()}))}},{key:"setMovements",value:function(){var t=this.state.movements,e=this.recalculateData(this.getFilteredMovements(t)),n=this.groupByMonths(e),a=this.getMothlySummary(n),s=this.getCushionMonths(a,e[e.length-1].sum),r={filterdMovements:e,byMonths:n,mothlySummary:a,cushion:s.months,expense_per_m:s.last_months_expenses,startDate:new Date(t[0].dateMillis),endDate:new Date(t[t.length-1].dateMillis)};this.setState(r)}},{key:"setStartDate",value:function(t){this.setState({startDate:t})}},{key:"setEndDate",value:function(t){this.setState({endDate:t})}},{key:"groupByMonths",value:function(t){var e=x()(t[0].date,"DD/MM/YYYY").startOf("month"),n=x()(t[t.length-1].date,"DD/MM/YYYY").startOf("month"),a=[],s=!1,r=e;do{if(r.isAfter(n)){s=!0;break}a.push(r.toDate()),r=r.add("1","month").startOf("month")}while(!s);var i=a.map((function(t){return{month:x()(t),monthDate:t,movements:[]}}));return i.forEach((function(e,n){e.movements=t.filter((function(t){return!t.skipped})).filter((function(t){return e.month.isSame(new Date(t.dateMillis),"month")}))})),i}},{key:"getMothlySummary",value:function(t){var e=t.map((function(t,e){var n=0,a=0;return t.movements.filter((function(t){return t.ammount>0})).forEach((function(t){n+=t.ammount})),t.movements.filter((function(t){return t.ammount<0})).forEach((function(t){a+=t.ammount})),Object(c.a)(Object(c.a)({},t),{},{earnings:n,expenses:a,resulting:n+a})})).sort((function(t,e){return t.month.isAfter(e.month)?1:t.month.isBefore(e.month)?-1:0})),n=e.map((function(t){return t.earnings})).reduce((function(t,e){return t+e}))/e.length,a=e.map((function(t){return t.expenses})).reduce((function(t,e){return t+e}))/e.length;return{total:e,totalAverageEarnings:n,totalAverageExpenses:a}}},{key:"getFilteredMovements",value:function(t){var e=t,n=this.state.endDate&&this.state.endDate.getTime(),a=this.state.endDate&&this.state.startDate.getTime(),s=null,r=null;return e.forEach((function(t,e){a&&t.dateMillis>=a&&null==s&&(s=e),n&&t.dateMillis>=n&&null==r&&(r=e+1)})),null==s||isNaN(s)||null==s||isNaN(r)||(e=e.slice(s,r)||[]),e=(e=e.map((function(t){return 150==Math.floor(t.ammount)&&(t.skipped=!0),t}))).filter((function(t){return!t.skipped}))}},{key:"round2",value:function(t){return parseFloat(Number(t).toFixed(2))}},{key:"getGeneralMothlyBarChart",value:function(){var t=this;return this.state.mothlySummary.total.map((function(e){return{earnings:t.round2(e.earnings),expenses:t.round2(-1*e.expenses),resulting:t.round2(e.resulting),date:e.month.format("MM/YYYY")}}))}},{key:"getCushionMonths",value:function(t,e){var n=t.total.length,a=t.total.slice(n-4,n+1).map((function(t){return t.expenses})).reduce((function(t,e){return t+e}));return a=this.round2(a/4),{months:this.round2(e/a*-1),last_months_expenses:a}}},{key:"checkboxMovement",value:function(t){var e=this;this.setState((function(e){var n=JSON.parse(JSON.stringify(e.movements));return n[t].skipped=!n[t].skipped,{movements:n}}),(function(){setTimeout((function(){e.setMovements()}),500)}))}},{key:"clearUrl",value:function(){this.storedUrl="",window.location.reload()}},{key:"getWidth",value:function(t){return document.getElementById(t)&&document.getElementById(t).offsetWidth||400}},{key:"render",value:function(){var t=this;return Object(a.jsxs)("div",{children:[Object(a.jsxs)(N.a,{id:"movement1",children:[Object(a.jsx)("h1",{children:"Main Balance"}),Object(a.jsx)(_.a,{onClick:this.clearUrl,children:"Clear URL"})]}),Object(a.jsx)(a.Fragment,{}),this.state.filterdMovements&&Object(a.jsxs)(N.a,{id:"movement2",children:[Object(a.jsx)("h3",{children:"Movements"}),Object(a.jsx)(F.a,{dateFormat:"dd/MM/yyyy",selected:this.state.startDate,onChange:this.setStartDate}),Object(a.jsx)(F.a,{dateFormat:"dd/MM/yyyy",selected:this.state.endDate,onChange:this.setEndDate}),Object(a.jsxs)(g.a,{width:this.getWidth("movement1"),height:this.chartHeight,data:this.state.filterdMovements,margin:{top:5,right:30,left:20,bottom:5},children:[Object(a.jsx)(y.a,{strokeDasharray:"3 3"}),Object(a.jsx)(M.a,{dataKey:"date"}),Object(a.jsx)(D.a,{}),Object(a.jsx)(k.a,{}),Object(a.jsx)(Y.a,{}),Object(a.jsx)(w.a,{type:"monotone",dataKey:"ammount",stroke:"#8884d8"}),Object(a.jsx)(w.a,{type:"monotone",dataKey:"sum",stroke:"#82ca9d"})]})]})||Object(a.jsx)(a.Fragment,{}),this.state.mothlySummary&&Object(a.jsxs)(N.a,{id:"movement3",children:[Object(a.jsx)("h3",{children:"Mothly Expenses / Earnings"}),Object(a.jsxs)(E.a,{width:this.getWidth("movement1"),height:this.chartHeight,data:this.getGeneralMothlyBarChart(),children:[Object(a.jsx)(y.a,{strokeDasharray:"3 3"}),Object(a.jsx)(M.a,{dataKey:"date"}),Object(a.jsx)(D.a,{}),Object(a.jsx)(k.a,{}),Object(a.jsx)(Y.a,{}),Object(a.jsx)(S.a,{dataKey:"earnings",fill:"green"}),Object(a.jsx)(S.a,{dataKey:"expenses",fill:"red"}),Object(a.jsx)(S.a,{dataKey:"resulting",fill:"blue"})]})]})||Object(a.jsx)(a.Fragment,{}),!Number.isNaN(this.state.cushion)&&Object(a.jsxs)(N.a,{children:[Object(a.jsxs)("h3",{children:["Expected cushion via last 4 - months averages ",Object(a.jsx)("small",{children:"(expected time to stand without receiving income)"})]}),Object(a.jsxs)("h4",{children:[this.state.cushion," months (",this.state.expense_per_m,"$/m)"]})]}),this.state.movements&&Object(a.jsx)(N.a,{children:Object(a.jsxs)(B.a,{children:[Object(a.jsx)("thead",{children:Object(a.jsxs)("tr",{children:[Object(a.jsx)("td",{children:"Enabled"}),Object(a.jsx)("td",{children:"Date"}),Object(a.jsx)("td",{children:"Movement"}),Object(a.jsx)("td",{children:"Motive"}),Object(a.jsx)("td",{children:"Current Balance"})]})}),Object(a.jsx)("tbody",{children:this.state.movements.map((function(e,n){return Object(a.jsxs)("tr",{children:[Object(a.jsx)("td",{children:Object(a.jsx)(U.a,{children:Object(a.jsx)(U.a.Group,{controlId:"enabled",children:Object(a.jsx)(U.a.Check,{id:"enabled-".concat(n),type:"checkbox",label:"Count in",onChange:function(){return t.checkboxMovement(n)},checked:!e.skipped})})})}),Object(a.jsx)("td",{children:e.date}),Object(a.jsx)("td",{children:e.ammount}),Object(a.jsx)("td",{children:e.motive}),Object(a.jsx)("td",{children:e.sum_display})]},"".concat(n,"-").concat(e.date.replace(/\//g,"-")))}))})]})})||Object(a.jsx)(a.Fragment,{})]})}},{key:"storedUrl",get:function(){return A.a.get("url")},set:function(t){A.a.set("url",t)}},{key:"chartHeight",get:function(){return window.innerHeight/3}}]),n}(r.a.Component),W=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,503)).then((function(e){var n=e.getCLS,a=e.getFID,s=e.getFCP,r=e.getLCP,i=e.getTTFB;n(t),a(t),s(t),r(t),i(t)}))};o.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(J,{})}),document.getElementById("root")),W()}},[[488,1,2]]]);
//# sourceMappingURL=main.86777755.chunk.js.map